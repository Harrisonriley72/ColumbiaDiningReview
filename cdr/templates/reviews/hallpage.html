{% extends "base.html" %}

{% block header %}
  <h1>{% block title %} {{ hallname }} {% endblock %}</h1>
{% endblock %}

{% block content %}
<div class="text-dark hall-page-text">
<div class="container">
  <div class="row">
    <div class="col-sm-4">
		<div class="card my-3">
		  <div class="card-header">
		    <p class="fw-bold">Foods served today</p>
		  </div>
		  <ul class="list-group list-group-flush">
			{% for foodrate in foodratings %}
			 <li class="list-group-item">
			 	{{foodrate.foodname}}: {{foodrate.avg}} * for {{foodrate.count}} ratings
			 	{% if g.user %}
			 	<span>
			 		<form method="POST" action="{{ url_for('reviews.rate_fooditem', foodname=foodrate.foodname, hallname_servedat=hallname, order_indic='0'+isactive1[0], from_page='hallpage') }}">
						<label for="rate">My Rating (between 1 and 5):</label>
						<input type="number" id="rate" name="rating" min="1" max="5" value="{{user_ratings_dict[foodrate.foodname]}}">
						<input type="submit">
			 		</form>
			 	</span>
			 	{% endif %}
			 </li>
			{% endfor %}
		  </ul>
		</div>    	
    </div>
    <div class="col-sm-8">   	

		<form method="POST" action="{{ url_for('reviews.update_order', hallname=hallname) }}">
			<div class="btn-group btn-group-toggle" data-toggle="buttons">
			  <label class="btn btn-secondary {{isactive1[0]}}">
			    <input type="radio" name="options" id="option1" autocomplete="off" {{isactive1[1]}} value="newest"> Newest
			  </label>
			  <label class="btn btn-secondary {{isactive2[0]}}">
			    <input type="radio" name="options" id="option2" autocomplete="off" {{isactive2[1]}} value="popular"> Most Popular
			  </label>
			</div>
			<button type="submit">Update</button>
		</form>

		<!-- <form method='POST' action="{{ url_for('reviews.add_review', hallname=hallname) }}">
			<button type="submit">Add Review</button>
		</form> -->

		<a class="btn btn-secondary" role="button" href="{{url_for('reviews.add_review', hallname=hallname)}}">Add Review</a>


    	{% for review in reviews %}
			<div class="card my-2">
			  <div class="card-header">
			  	<span class="fw-bold"><a href="{{ url_for('reviews.profile', email=review.email, order=0)}}">{{review.fname}} {{review.lname}}</a></span>
			  	<span class="text-right">{{review.time}}</span>
			  </div>
			  <div class="card-body">
			  	<div class="row">
			  		<div class="col-sm-5"> 
					  	<p class="fw-bold">Rating: {{review.rating}}<p>
					  	<div class="mt-3">
					    <span class="fw-bold">{{review.like_number}} Likes</span>
					    <a href="{{ url_for('reviews.increment', email=review.email, time=review.time, hallname=hallname, order_indic='0'+isactive1[0], from_page='hallpage') }}" class="btn btn-secondary mx-3">
					    	{% if g.user and review.liker_email %}un{% endif %}like
					    </a>
					    </div>			  		
				  	</div>

				  	<div class="col-sm"> 
					    <p class="card-text">{{review.comment}}</p>
					</div>
			    </div>
			  </div>
			</div>
	    
		{% endfor %}
	</div>
  </div>
</div>

</div>

{% endblock %}